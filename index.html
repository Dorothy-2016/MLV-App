<html>
    <head>
        <meta charset="utf-8"/>
    </head>
    <body onload="test()">
        <script>
            var LinkColour = "rgb(100,130,160)";

            function DealWithResponse()
            {
                // console.log(this.responseText);
                var Releases = JSON.parse(this.responseText);
                var findImg = /(https?:\/\/.*\.(?:png|jpg))/i;

                /* Find latest Qt Release */
                for (var i = 0; i < Releases.length; i++)
                {
                    if (Releases[i].name.includes("[Qt]"))
                    {
                        console.log(Releases[i].name);
                        for (var j = 0; j < Releases[i].assets.length; j++)
                        {
                            let link = document.createElement("a");
                            link.href = Releases[i].assets[j].browser_download_url;
                            let text = document.createElement("h4");
                            text.innerHTML = Releases[i].assets[j].name;
                            text.style.color = LinkColour;
                            link.appendChild(text);
                            document.getElementById("QtAssets").appendChild(link);
                        }
                        document.getElementById("QtVer").innerHTML = document.getElementById("QtVer").innerHTML + Releases[i].tag_name;
                        document.getElementById("QtTime").innerHTML = document.getElementById("QtTime").innerHTML + Releases[i].published_at;
                        document.getElementById("QtPic").src = Releases[i].body.match(findImg);
                        break;
                    }
                }
                /* Find latest Cocoa Release */
                for (var i = 0; i < Releases.length; i++)
                {
                    if (Releases[i].name.includes("[Cocoa]"))
                    {
                        console.log(Releases[i].name);
                        for (var j = 0; j < Releases[i].assets.length; j++)
                        {
                            let link = document.createElement("a");
                            link.href = Releases[i].assets[j].browser_download_url;
                            let text = document.createElement("h4");
                            text.innerHTML = Releases[i].assets[j].name;
                            text.style.color = LinkColour;
                            link.appendChild(text);
                            document.getElementById("CocoaAssets").appendChild(link);
                        }
                        document.getElementById("CocoaVer").innerHTML = document.getElementById("CocoaVer").innerHTML + Releases[i].tag_name;
                        document.getElementById("CocoaTime").innerHTML = document.getElementById("CocoaTime").innerHTML + Releases[i].published_at;
                        var imgURL = Releases[i].body.match(findImg);
                        document.getElementById("CocoaPic").src = imgURL;
                        document.getElementById("CocoaPic").src = document.getElementById("CocoaPic").src.substring(0, document.getElementById("CocoaPic").src.indexOf('.png')) + ".png";
                        break;
                    }
                }
            }
            function test()
            {
                // Create a new request object
                var request = new XMLHttpRequest();
                request.onload = DealWithResponse;
                // Initialize a request
                request.open('get', 'https://api.github.com/repos/ilia3101/MLV-App/releases')
                // Send it
                request.send()
            }
        </script>

        <style>
            h1, h2, h3, h4 {
                font-weight: 500;
                letter-spacing: 0.011em;
            }
            h1 { font-size: 55px; }
            h2 { font-size: 32px; }
            h3 { font-size: 25px; }
            h1, h2, h2, h3, h4, h5, h6 {
                font-family: "SF Pro Display", "SF Pro Icons", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
                color: #333;
            }
            body {
                background-color: #ffffff;
            }
            a {
                text-decoration: none;
                color: #acf;
            }
        </style>

        <div style="position: fixed; left: 0px; top: 0px; width:100vw; height:100px; background-color: #333;">
                <div style="width:980px; margin: auto;">
                    <h2 style="color: #eee;">MLV App Downloads</h2>
                </div>
        </div>

        <div style="width:980px; margin: auto;">
            <br /><br /><br /><br /><br /><br /><br />
            
            <table>
                <td style="width: 490px; vertical-align: top;">
                    <h2>Qt App</h2>
                    <img id="QtPic" style="max-width:80%; max-height:220px;"></img>
                    <h4 id="QtVer">Latest Version: </h4>
                    <h4 id="QtTime">Published At: </h4>
                    <h4>Downloads:</h4>
                    <div id="QtAssets"></div>
                </td>
                <td style="width: 490px; vertical-align: top;">
                    <h2>Cocoa App</h2>
                    <img id="CocoaPic" style="max-width:80%; max-height:220px;"></img>
                    <h4 id="CocoaVer">Latest Version: </h4>
                    <h4 id="CocoaTime">Published At: </h4>
                    <h4>Downloads:</h4>
                    <div id="CocoaAssets"></div>
                </td>
            </table>
        </div>

    </body>
</html>